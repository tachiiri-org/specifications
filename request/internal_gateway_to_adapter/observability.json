{
  "scope": "Observability for internal calls from internal-gateway to adapter endpoints.",
  "version": 1,
  "request_id": {
    "header": "x-request-id",
    "generated_by": "receiver_if_missing",
    "overwrite_if_present": false,
    "propagation": "downstream",
    "echo_to_response": true,
    "notes": [
      "Matches request/internal_geteway_to_adapter/headers.json: generate_on_receiver.x-request-id.required=true and overwrite_if_present=false."
    ]
  },
  "tracing": {
    "traceparent": {
      "supported": true,
      "propagation": "passthrough",
      "generate_if_missing": false,
      "header": "traceparent",
      "notes": [
        "Matches request/internal_geteway_to_adapter/headers.json passthrough_to_downstream.allowlist includes traceparent.",
        "Matches request/internal_geteway_to_adapter/http.json observability.trace_header is traceparent."
      ]
    }
  },
  "idempotency": {
    "supported": true,
    "header": "x-idempotency-key",
    "required_for_operations_ref": "request/internal_geteway_to_adapter/http.json#/idempotency/required_for_operations",
    "notes": [
      "Matches request/internal_geteway_to_adapter/http.json idempotency.key_header = x-idempotency-key.",
      "Whether the header is required is operation-dependent; absence when required should be treated as a client error by the receiver."
    ]
  },
  "logging": {
    "required_fields": [
      "request_id",
      "service",
      "resource",
      "property",
      "operation",
      "status",
      "latency_ms"
    ],
    "optional_fields": [
      "traceparent",
      "idempotency_key_present",
      "upstream_target",
      "upstream_status"
    ],
    "notes": [
      "Do not log x-internal-assertion or external credentials.",
      "Adapters may emit richer audit logs per request/internal_geteway_to_adapter/boundary.json audit_log section; this file focuses on request-level observability."
    ]
  }
}