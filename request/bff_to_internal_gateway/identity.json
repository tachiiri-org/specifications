{
  "scope": "Identity propagation for internal calls from BFF to internal-gateway.",
  "version": 1,
  "transport": {
    "kind": "internal_assertion",
    "header": "x-internal-assertion"
  },
  "assertion_requirements": {
    "required_headers": [
      "x-internal-assertion"
    ],
    "optional_headers": [
      "x-contract-version",
      "traceparent"
    ]
  },
  "verification": {
    "on_receiver": {
      "verify": "verify signature/issuer/audience/expiration; decode claims into normalized actor model",
      "on_fail": {
        "action": "reject",
        "status": 401,
        "error_code": "unauthorized"
      },
      "on_success": {
        "use": "receivers MUST use only decoded claims; MUST NOT accept any alternative identity headers"
      }
    }
  }
}